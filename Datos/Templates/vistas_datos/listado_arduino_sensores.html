{% block content %}

<h2>Listado de Arduinos y Sensores</h2>
<table border="1">
    <thead>
        <tr>
            <th>ID Arduino</th>
            <th>Modelo</th>
            <th>Estado</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for arduino in arduinos %}
        <tr>
            <td>{{ arduino.id_arduino }}</td>
            <td>{{ arduino.modelo_arduino }}</td>
            <td>{% if arduino.estado == 1 %}
                    Activo
                {% else %}
                    Inactivo
                {% endif %}
            </td>
            <td>
                <a href="{% url 'cambiar_estado_arduino' arduino.id_arduino %}" class="btn btn-primary">
                    Cambiar Estado
                </a>
            </td>
        </tr>

        <!-- Listado de Sensores relacionados -->
        {% for sensor in arduino.sensor_set.all %}
        <tr>
            <td colspan="2"> â†’ Sensor {{ sensor.id_sensor }} ({{ sensor.id_modelo_sensor.nombre_sensor }})</td>
            <td>{% if sensor.estado == 1 %}
                    Activo
                {% else %}
                    Inactivo
                {% endif %}
            </td>
            <td>
                {% if arduino.estado == 1 %}
                    <a href="{% url 'cambiar_estado_sensor' sensor.id_sensor %}" class="btn btn-warning">
                        Cambiar Estado
                    </a>
                {% else %}
                    <button class="btn btn-secondary" disabled>Arduino Apagado</button>
                {% endif %}
            </td>
        </tr>
        {% endfor %}

        {% empty %}
        <tr><td colspan="4">No hay Arduinos registrados.</td></tr>
        {% endfor %}
    </tbody>
</table>

<h2>Lista de Registros</h2>
    <table border="1">
        <tr>
            <th>Valor</th>
            <th>Fecha de Registro</th>
        </tr>
        {% for registro in registros %}
        <tr>
            <td>{{ registro.valor }}</td>
            <td>{{ registro.fecha_registro }}</td>
        </tr>
        {% endfor %}
    </table>


{% endblock %}